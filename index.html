<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earth</title>
    <style>
        /*html{width: 100%; height: 100%;}*/
        /*body { width: 100%; height: 100%;margin: 0; overflow: hidden; background-color: #000; }*/
        /*#webgl {*/
        /*width: 100px;*/
        /*height: 100px;*/
        /*}*/
        /*.webgl-error { font: 15px/30px monospace; text-align: center; color: #fff; margin: 50px; }*/
        /*.webgl-error a { color: #fff; }*/

        .diagramHeader {
            width:100%;
            text-align:center;
        }

    </style>

    <link rel='icon' href='img/logo_black.ico' type=‘image/x-ico’>
    <script src="js/resource/jquery.min.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="js/resource/bootstrap.min.js"></script>
    <script src="js/resource/three.min.js"></script>
    <script src="js/resource/TrackballControls.js"></script>

    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/indexMobile.css">

    <script src="./js/resource/d3.min.js"></script>
    <script src="js/threeLib/threeLibUtils.js"></script>
    <script src="js/threeLib/threeLibGateway.js"></script>
    <script src="js/graphicLib/graphicLibUtils.js"></script>
    <script src="js/graphicLib/graphicLibGateway.js"></script>
    <script src="js/index.js"></script>
    <script src="js/resource/pagination.js"></script>
    <script src="js/text.js"></script>
    <script src="testgraphicdata/dotdata.js"></script>

</head>
<body>

<img id="smallIcon" src="img/logo.png">

<nav id="hideNav">
    <h2>Search Country</h2>
    <input type="text" placeholder="Country">
    <button id="smallButton1" class="btn" data-toggle="modal" data-target="#modal">See Info</button>
    <button id="smallButton2" class="btn" data-toggle="modal" data-target="#modal2">Famous Earthquake</button>
    <button id="smallButton3" class="btn" data-toggle="modal" data-target="#modal3">About Us</button>
    <div>
        <select name="type" title="Select Language">
            <option value="">Language</option>
            <option value="english">English</option>
            <option value="chinese">Chinese</option>
        </select>
    </div>
</nav>

<div id="curtain"></div>

<aside>
    <img src="img/logo.png">
    <h2></h2>
    <input type="text" placeholder="">
    <button id="button1" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#modal"></button>
    <button id="button2" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#modal2"></button>
    <button id="button3" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#modal3"></button>
</aside>

<div id="modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="modalLabel"></h4>
            </div>
            <div id="chartArea" class="modal-body">
            </div>
            <div id="paginationArea" style="text-align: center">
                <ul id="pagination" class="pagination"></ul>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="modal2" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body">

                <h5><a href="https://en.wikipedia.org/wiki/1906_San_Francisco_earthquake"></a></h5>
                <p></p>

                <h5><a href="https://en.wikipedia.org/wiki/1923_Great_Kant%C5%8D_earthquake"></a></h5>
                <p></p>

                <h5><a href="https://en.wikipedia.org/wiki/1960_Valdivia_earthquake"></a></h5>
                <p></p>

                <h5><a href="https://en.wikipedia.org/wiki/1964_Alaska_earthquake"></a></h5>
                <p></p>

                <h5><a href="https://en.wikipedia.org/wiki/2004_Indian_Ocean_earthquake_and_tsunami"></a></h5>
                <p></p>

            </div>

        </div>

    </div>
</div>

<div class="modal fade" id="modal3" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" id="about"></h4>
            </div>
            <div class="modal-body">
                <h5>This project is designed to raise attention of the audience on earthquake hazards.</h5>
                <p>In order to raise awareness of the public, our project has created a 3D earth and historical
                    earthquake
                    data points are added to 3D earth accordingly. Graphical analysis of earthquake magnitude v.s. time,
                    number
                    of earthquakes v.s. monthly distribution, earthquake magnitude v.s. Geolocation are provided to user
                    for additional
                    information . Users can also filter earthquake magnitude and countries information accordingly.
                    Informations such as
                    6 famous earthquakes has also been added to the website feature. </p>
            </div>
        </div>

    </div>
</div>

<div id="language">
    <select name="type" title="Select Language">
        <option value=""></option>
        <option value="english"></option>
        <option value="chinese"></option>
    </select>
</div>

<div id="webgl"></div>

</body>

<script>

    testinggeodata.forEach(function(feature){
        if(feature.properties.alert){
            var newitem={};
            newitem.depth=feature.geometry.coordinates[2];
            newitem.time=feature.properties.time;
            newitem.mag=feature.properties.mag;
            newitem.alert=feature.properties.alert;
            newitem.place=feature.properties.place;
			
            dotdepthdata.push(newitem);}
    });

    testinggeodata.forEach(function(feature){
        if(feature.properties.time>(new Date("2016-10-1")).getTime()){
            var newitem={};
            newitem.lat=feature.geometry.coordinates[1];
            newitem.lng=feature.geometry.coordinates[0];
            newitem.mag=feature.properties.mag;
            newitem.alert=feature.properties.alert;
            newitem.place=feature.properties.place;
            newitem.time=feature.properties.time;
			newitem.iso3="JPN";
            dotgeodata.push(newitem);
        }
    });

    renderPagination(20, 1);

    var dataLink = {
        "onload": "/API/Initialize",
        "top10": "/API/top10",
        "dotData": "/API/DotData",
        "yearData": "/API/yearData",
        "depthData": "/API/depthData"
    };
	
	var Global_Country_Name = "Japan";
	
	////-----global variable for test language -------
	var language ="english";
	////-------------------------------------------
	
	var chartHeading={
		"top10":{
			"chinese":"十大地震高发国家",
			"english":"TOP 10 COUNTRIES"
		},
		"dotData":{
			"chinese":"地震分布图",
			"english":"EARTHQUAKE GEO MAP"
		},
		"yearData":{
			"chinese":"过去12个月地震次数",
			"english":"EARTHQUAKE FREQUENCE IN PAST 12 MONTHS"
		},
		"depthData":{
			"chinese":"地震深度图",
			"english":"EARTHQUAKE DEPTH MAP"
		}
	}
    var top10Data = [{country: 'United States', counts: 600},
        {country: 'China', counts: 400},
        {country: 'Russia', counts: 200},
        {country: 'Japan', counts: 200},
        {country: 'United Kindom', counts: 200},
        {country: 'Indianisia', counts: 200},
        {country: 'blahblahblah', counts: 200},
        {country: 'blah1', counts: 200},
        {country: 'blah2', counts: 200},
        {country: 'blah3', counts: 200}];

    GraphicChart.createGeoDotChart(dotgeodata,"#chartArea",null,"geo diagram","JPN");
//    GraphicChart.createTop10PieChart(top10Data, "#chartArea", null, "top 10");
	
	var getDiagramData =function(url,method,inputData,chartCreation,heading){
		$.ajax({
			url: url,
			type: method?method:"GET",
			contentType: "application/json; charset=utf-8",
			async: true,
			data: data,//JSON.stringify({"countryName": Global_Country_Name}),
			dataType: 'json',
			success: function (data) {
				chartCreation(data,"#chartArea",null,heading,data[0].iso3);
			}
		});
	}
	
    function renderPage(pageNumber) {
//        $.ajax({
//            url: '../store/product',
//            type: 'POST',
//            contentType: "application/json; charset=utf-8",
//            async: true,
//            data: JSON.stringify({"storeID": getUrlParameter("storeID"), "pageID": pageNumber}),
//            dataType: 'json',
//            success: function (productListData) {
//                console.log(productListData);
//                renderProductList(productListData.productList);
//                renderPagination(productListData.productNumber, productListData.pageID);
//                bindClickButton();
//                bindLink();
//            }
//        });

        GraphicChart.removeAll();

        if (pageNumber == 1) {

			getDiagramData(dataLink.dotData,
						   "POST",
						   JSON.stringify({"countryName": Global_Country_Name}),
						   GraphicChart.createGeoDotChart,
						   chartHeading.dotData[language]);
           // GraphicChart.createGeoDotChart(dotgeodata,"#chartArea",null,"geo diagram","JPN");
        } else if (pageNumber == 2) {
			getDiagramData(dataLink.depthData,
						   "POST",
						   JSON.stringify({"countryName": Global_Country_Name}),
						   GraphicChart.createDepthDotChart,
						   chartHeading.depthData[language]);
           // GraphicChart.createDepthDotChart(dotdepthdata,"#chartArea",null,"depth diagram");
        } else if (pageNumber == 3) {
			getDiagramData(dataLink.top10,
						   "GET",
						   null,
						   GraphicChart.createTop10PieChart,
						   chartHeading.top10[language]);
            //GraphicChart.createTop10PieChart(top10Data, "#chartArea", null, "top 10");
        } else {
			getDiagramData(dataLink.yearData,
						   "POST",
						   JSON.stringify({"countryName": Global_Country_Name}),
						   GraphicChart.createYearlyBarChart,
						   chartHeading.yearData[language]);
            //GraphicChart.createYearlyBarChart(yearlydata,"#chartArea", null," yearly report");
        }

        renderPagination(20, pageNumber);
    }

    var yearlydata=[
        {month:"Jan",counts:300},
        {month:"Feb",counts:340},
        {month:"Mar",counts:500},
        {month:"Apr",counts:366},
        {month:"May",counts:500},
        {month:"Jun",counts:345},
        {month:"Jul",counts:390},
        {month:"Aug",counts:600},
        {month:"Sep",counts:432},
        {month:"Oct",counts:501},
        {month:"Nov",counts:600},
        {month:"Dev",counts:483}
    ];
    //
    //GraphicChart.createYearlyBarChart(yearlydata,"#chartArea", null," yearly report");

    var seasonaldata=[
        {dayrange:"1/1-1/10",counts:390},
        {dayrange:"1/11-1/20",counts:300},
        {dayrange:"1/21-1/30",counts:320},
        {dayrange:"1/31-2/9",counts:308},
        {dayrange:"2/10-2/19",counts:330},
        {dayrange:"2/20-3/1",counts:350},
        {dayrange:"3/2-3/11",counts:500},
        {dayrange:"3/12-3/21",counts:300},
        {dayrange:"3/22-3/31",counts:300}
    ];
    //
    //GraphicChart.createSeasonalBarChart(seasonaldata,"#chartArea", null," seasonal report");
    //
    //GraphicChart.createDepthDotChart(dotdepthdata,"#chartArea",null,"depth diagram");


</script>

</html>